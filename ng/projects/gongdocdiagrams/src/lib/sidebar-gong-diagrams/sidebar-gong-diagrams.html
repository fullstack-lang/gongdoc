<div #innerHTMLelement>
    <mat-toolbar>
        <span>Gong Elements</span>
        <span class="example-spacer"></span>
    </mat-toolbar>

    <mat-tree [dataSource]="dataSource" [treeControl]="treeControl">

        <!-- This is the tree node template for leaf nodes -->
        <mat-tree-node class="node-link" *matTreeNodeDef="let node" matTreeNodePadding>
            <div [cdkDropListDisabled]="false" (cdkDropListDropped)="dropped($event, node)" cdkDropList>
                <!-- use a disabled button to provide padding for tree leaf -->
                <button mat-icon-button disabled></button>
                <div *ngIf="node.present; then leafPresentBlock else leafNotPresentBlock"></div>
                <ng-template #leafPresentBlock>
                    <span>{{node.name}} &nbsp;</span>
                    <mat-icon class="node-link-icon" (click)="removeNodeFromDiagram(node)">
                        visibility_off_outline
                    </mat-icon>
                </ng-template>
                <ng-template #leafNotPresentBlock>
                    <div *ngIf="node.draggable; then leafDraggableBlock else leafNotDraggableBlock"></div>
                    <ng-template #leafDraggableBlock>
                        <span cdkDrag>{{node.name}} &nbsp;</span>
                        <mat-icon cdkDrag class="node-link-icon">
                            person_add
                        </mat-icon>
                    </ng-template>
                    <ng-template #leafNotDraggableBlock>
                        <span>{{node.name}} &nbsp;</span>
                        <mat-icon class="node-link-icon">
                            person_add_alt
                        </mat-icon>
                    </ng-template>
                </ng-template>
            </div>
        </mat-tree-node>

        <!-- This is the tree node template for expandable nodes -->
        <mat-tree-node class="node-link" *matTreeNodeDef="let node;when: hasChild" matTreeNodePadding>

            <!-- This is the chevron stuff-->
            <button mat-icon-button matTreeNodeToggle [attr.aria-label]="'Toggle ' + node.name">
                <mat-icon class="mat-icon-rtl-mirror">
                    {{treeControl.isExpanded(node) ?
                    'expand_more' :
                    'chevron_right'
                    }}
                </mat-icon>
            </button>

            <!-- if then else block to deal with present / not present node -->
            <div *ngIf="node.present; then blockForGongStructInstancePresentInDiagram else otherCases"></div>

            <!-- if the gong struct is present in the diagram, have a button to have it removed -->
            <ng-template #blockForGongStructInstancePresentInDiagram>
                <div>
                    <span>{{node.name}} &nbsp;</span>
                </div>
                <mat-icon class="node-link-icon" (click)="removeNodeFromDiagram(node)">
                    visibility_off_outline
                </mat-icon>
            </ng-template>

            <!-- if the gong struct is not present or if it is an expandable of the gong struct -->
            <ng-template #otherCases>

                <!-- if then else block definition node.level == 1 is for gong struct-->
                <div *ngIf="node.level == 1 || node.level == 3; then blockForGongStructInstanceNotPresentInDiagram else otherNodes">
                </div>

                <!-- if this is a gong struct, have it draggable -->
                <ng-template #blockForGongStructInstanceNotPresentInDiagram>
                    <div [cdkDropListDisabled]="false" (cdkDropListDropped)="dropped($event, node)" cdkDropList>
                        <span cdkDrag>{{node.name}}
                            &nbsp;</span>
                    </div>
                </ng-template>

                <!-- if this is not a gong struct, then display the name -->
                <ng-template #otherNodes>
                    <div>
                        <span>{{node.name}} &nbsp;</span>
                    </div>
                </ng-template>
            </ng-template>
        </mat-tree-node>
    </mat-tree>
</div>